# 파드
## Pod의 개념 및 사용하기
+ 컨테이너를 표현하는 k8s API의 최소 단위
+ Pod에는 하나 또는 여러 개의 컨테이너가 포함될 수 있음  
<br>

## Pod 동작 flow
1. 쿠버네티스에 명령을 내리면 API가 해당 명령이 제대로된 문법인지 확인한다.
2. etcd에서 정보를 받아와 Scheduler에 넘긴다.
3. Scheduler는 웹서버 Pod를 어디에 실행하면 가장 좋을지 선택한다.
1. 하나의 Pod는 어디로 배치될지 스케줄링 받을 때까지는 Pending 상태로 표시한다.  
2. 스케줄링을 받은 후에는 Running 상태가 된다.
3. 성공/실패하는 경우 Succeeded/Failed로 표시한다.  
<br>

## Pod 생명주기 
+ Pending : 쿠버네티스 시스템에 파드를 생성하는 중임을 뜻하며, 이 상태는 컨테이너 이미지를 다운로드한 후 전체 컨테이너를 실행하는 도중이므로 파드 안의 전체 컨테이너가 실행될 때까지 시간이 걸린다.
+ Running : 파드 안 모든 컨테이너가 실행 중인 상태를 말한다.
+ Succeeded : 파드 안 모든 컨테이너가 정상 실행 종료된 상태로 재시작되지 않는 상태이다.
+ Failed : 파드 안 컨테이너 중 정상적으로 실행 종료되지 않은 컨테이너가 있는 상태이다. (컨테이너 종료 코드가 0이 아니면 비정상 종료이거나 시스템이 직접 컨테이너를 종료한 것)
+ Unknown : 파드의 상태를 확인할 수 없는 경우로 보통 파드가 있는 노드와 통신할 수 없을 때를 의미한다.  
<br>

## 동작 중인 Pod 확인
```bash
$ kubectl delete pod --all
$ kubectl get pods -o wide --watch
```
너무 많은 Pod 정보가 나오면 상태를 보기가 어렵기 때문에 delete를 이용하여 먼저 삭제해 준다.
--watch를 사용하면 line by line으로 현재 상태를 표시해 준다.
<br>

## Pod 관리하기
+ 동작 중인 파드 정보 보기
  ```bash
  $ kubectl get pods
  $ kubectl get pods -o wide
  $ kubectl describe pod webserver
  ```
+ 동작 중인 파드 수정
  ```bash
  $ kubectl edit pod webserver
  ```
+ 동작 중인 파드 삭제
  ```bash
  $ kubectl delete pod webserver
  $ kubectl delete pod --all
  ```
+ 전체 namespace에서 동작 중인 파드 모두 확인
  ```bash
  $ kubectl get pods --all-namespaces
  ```
  --all-namespaces를 빼면 default namespace의 파드들만 확인 가능하다.

## Liveness Prove를 이용한 self-healing Pod
Self-healing : 컨테이너가 제대로 동작되지 않을 때 재시작해주는 기능이다. (건강한 컨테이너만 가지고 애플리케이션 서비스를 지원하는 것을 보장)
  
### Liveness Prove
self-healing 기능이 포함되게 하려면 컨테이너에 livenessProbe를 배치시켜야 한다.


