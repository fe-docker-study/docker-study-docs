### 전통적인 아키텍처 (Monolithic)과의 비교

![image](https://user-images.githubusercontent.com/47748246/163299721-78980bfc-e47e-4307-826b-9c4d3d1217bf.png)

**Monolithic Architecture**

![image](https://user-images.githubusercontent.com/47748246/163299786-d9fa324a-d060-4f82-b4bd-2b1e8521a45d.png)

간단한 온라인 쇼핑몰 monolithic architecture 예시

- 전체 애플리케이션이 하나로 되어있음. 보통 동일한 개발 툴로 개발됨.
- 배포 및 테스트도 하나의 애플리케이션만 수행하면 되기 때문에 개발 및 환경설정이 간단함.
- 각 컴포넌트들이 함수로 호출되기 때문에 성능 제약이 덜하고, 운영 관리가 용이함

- 따라서 작은 볼륨의 시스템을 개발할 때는 유용하지만, 시스템이 커지고 여러 컴포넌트들이 더해지면 문제가 발생할 수 있다 .

![image](https://user-images.githubusercontent.com/47748246/163299812-fb0dc28c-149d-4006-80f4-05c667607549.png)

기능이 추가된 온라인 쇼핑몰 monolithic architecture 예시

문제점)

- **빌드/테스트 시간이 길어진다.**
    - 작은 수정에도 시스템 전체를 빌드해야 하며, 테스트 시간도 길어진다.
- **선택적 확장이 불가능하다.**
    - 이벤트로 인해 특정 서비스의 접속량이 폭증할 경우, 프로젝트 전체를 확장해야 한다.
- **하나의 서비스가 모든 서비스에 영향을 준다.**
    - 이벤트 서비스에 트래픽이 몰려 해당 서버가 죽게 된다면 다른 모든 서비스 역시 마비되는 상황이 오게 된다.

**MSA**

- 단일 프로그램을 각 컴포넌트 별로 나누어 작은 서비스의 조합으로 구축하는 방법

![image](https://user-images.githubusercontent.com/47748246/163299839-a03b1cd2-db43-4050-a7c1-6a9254fc7a87.png)

온라인 쇼핑몰에 MSA 적용 예시

- 각 컴포넌트는 서비스 형태로 구현되고, **API를 이용하여 타 서비스와 통신**하게 된다.
- 각 서비스는 독립된 서버로 타 컴포넌트와 의존성이 없기 때문에 **독립된 배포**를 하게된다.
- 또한 각 컴포넌트가 독립된 서비스로 개발되었기 때문에 **부분적인 확장**이 가능하다.

### MSA란?

- 각각의 독립된 서비스들이 인터페이스를 통해 통신하면서 하나의 큰 시스템을 이루는 것
    - 각 서비스 간 Network를 통해, 보통 **HTTP**를 통해
    - **독립된 배포** 단위
    - 각 서비스는 **쉽게 교체 가능**
    - 각 서비스는 **기능 중심**으로 구성됨. ex) 프론트 앤드, 추천, 정산, 상품 등
    - **각 서비스에 적합한 프로그래밍 언어, 데이터베이스, 환경**으로 만들어짐
    - 서비스는 **크기가 작고**, 상황에 따라 **경계**를 정하고, **자율적으로 개발**되고, **독립적으로 배포**되고, **분산**되고, **자동화된 프로세스**로 구축되고 배포된다.

- **특징**
    - **데이터 분리**
        - 데이터 저장 시 하나의 DB에 중앙 집중화를 하지 않고 **서비스 별로 별도의 데이터베이스를 사용**한다.
        - 데이터가 분산되어 있기 때문에 다른 서비스 컴포넌트에 대한 의존성 없이 서비스를 독립적으로 개발 및 배포/운영할 수 있지만, **다른 컴포넌트의 데이터를 API 통신을 통해 가져와야 하기 때문에 성능상의 문제**가 발생할 수 있고, 트랜잭션으로 묶을 수 없는 문제가 발생하기도 함.
        - 데이터 정합성에 문제가 생길 수도 있다.
    
    - **API Gateway**
        - MSA는 각 서비스가 다른 서버에 분리 배포되어 있기 때문에 서버 URL이 각기 다를 수밖에 없다.
        - 따라서 API Gateway를 사용하여 API 서버 앞 단에서 모든 API 서버들의 End-Point를 단일화하여 묶어주는 역할을 한다.
        - 그 외에도 라우팅, 로드밸런싱, 인증 역할 등등 여러 역할을 수행한다.

### MSA의 장점

우선 MSA의 장점에 대해 알아보도록 하겠습니다. MSA는 서비스가 커지면서 생겼던 Monolithic Architecture의 문제점들을 어느정도 보완해 줄 수 있습니다.

- 배포(deployment) 관점 : 서비스 별 개별 배포 가능 ( 배포 시 전체 서비스의 중단이 없음)
    - 요구사항을 신속하게 반영하여 빠르게 배포할 수 있음.
- 확장(scaling) 관점 : 특정 서비스에 대한 확장성이 용이함.
    - 클라우드 사용에 적합한 아키텍쳐.
- 장애(failure) 관점 : 장애가 전체 서비스로 확장될 가능성이 적음
    - 부분적 장애에 대한 격리가 수월함

### MSA의 단점

Monolithic Architecture은 단순한 아키텍쳐인데 비해 MSA는 보다 복잡한 아키텍쳐로, 전체 서비스가 커짐에 따라 그 복잡도가 기하급수적으로 늘어날 수 있습니다.

- 성능 - 서비스 간 호출 시 API를 사용하기 때문에, 통신 비용이나, Latency가 그만큼 늘어나게 됩니다.
- 테스트 / 트랜잭션 - 서비스가 분리되어 있기 때문에 테스트와 트랜잭션의 복잡도가 증가하고, 많은 자원을 필요로 합니다.
- 데이터 관리 - 데이터가 여러 서비스에 걸쳐 분산되기 때문에 한번에 조회하기 어렵고, 데이터의 정합성 또한 관리하기 어렵습니다.
